---
import type { CollectionEntry } from "astro:content";
import "@fontsource/space-grotesk";
import "@fontsource/caveat";
import BaseLayout from "../layouts/BaseLayout.astro";
import { ScrollingText } from "../components/ScrollingText";
import PageProgress from "../components/PageProgress.astro";
import { PageTransition } from "../components/PageTransition";
import OtherProjects from "../components/OtherProjects.astro";
import Image from "../components/Image.astro";

type Props = CollectionEntry<"project">["data"] & {
  showDates?: boolean;
};

const {
  title,
  pubDate,
  updatedDate,
  description,
  heroImage,
  headerColor,
  showDates,
} = Astro.props;

const formatter = Intl.DateTimeFormat("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});
---

<BaseLayout title={title} description={description}>
  <PageTransition background={headerColor} client:load />
  <ScrollingText text={title} background={headerColor} client:only />
  <article id="markdown-content">
    <Image
      aria-hidden="true"
      src={heroImage}
      alt={description}
      loading="eager"
    />
    <h1 class="sr-only">{title}</h1>

    {
      showDates && (
        <section class="text-center">
          Publised on{" "}
          <time datetime={formatter.format(pubDate)}>
            {formatter.format(pubDate)}
          </time>
          {updatedDate && (
            <>
              , last updated on{" "}
              <time datetime={formatter.format(updatedDate)}>
                {formatter.format(updatedDate)}
              </time>
            </>
          )}
        </section>
      )
    }

    <section
      class="pt-40 pb-72 max-w-7xl m-auto px-4 font-extrabold text-center"
    >
      <div class="text-6xl md:text-7xl">{description}</div>
    </section>
    <section class="container pb-32 m-auto">
      <slot />
    </section>
  </article>
  <ScrollingText text="More work" client:only direction="right" />
  <OtherProjects currentProject={title} background={headerColor} />
  <PageProgress color={headerColor} />
</BaseLayout>
