---
import { getCollection } from "astro:content";
import Image from "../components/Image.astro";

type Props = {
  currentProject: string;
  background: string;
};

const { currentProject, background } = Astro.props;

const projects = (await getCollection("portfolio"))
  .filter((project) => project.data.title !== currentProject)
  .sort(() => Math.random() - 0.5);
---

<aside class="w-full py-32" style={{ background }}>
  <h2 class="sr-only">My work</h2>
  <ol
    class="flex w-full gap-2 px-12 pb-8 overflow-x-auto md:gap-12 snap-x snap-mandatory scroll-px-12"
  >
    {
      projects.map((project) => (
        <li class="snap-always snap-center md:snap-end relative shrink-0 w-[75vw] md:w-[60vw] lg:w-[35vw]">
          <a
            class="h-full"
            href={`/portfolio/${project.slug}`}
            aria-label={`project: ${project.data.title},${project.data.description}`}
          >
            <Image
              width={320}
              height={240}
              src={project.data.heroImage}
              alt={project.data.description}
              aria-hidden="true"
            />
            <div class="text-xl font-extrabold">
              {project.data.title}{" "}
              <span class="font-light description">
                {project.data.description}
              </span>
            </div>
          </a>
        </li>
      ))
    }
  </ol>
</aside>

<style>
  .description::before {
    @apply inline-block px-1;
    content: "|";
  }
</style>
