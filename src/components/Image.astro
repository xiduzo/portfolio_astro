---
export interface Props extends astroHTML.JSX.ImgHTMLAttributes {
  src: string
  alt: string
  quality?: number
  width?: 320 | 640 | 1280 // image sizes we generate in the config
}

const { src, alt, quality = 75, width = 640, ...rest } = Astro.props
const optimizedURL =
  import.meta.env.MODE === 'production'
    ? `/_vercel/image?url=${encodeURIComponent(src)}&w=${width}&q=${quality}`
    : src

console.log(src, optimizedURL)
---

<img loading="lazy" src={optimizedURL} alt={alt} {...rest} />