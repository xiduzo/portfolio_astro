---
import { getCollection } from "astro:content";
import Image from "../components/Image.astro";

type Props = {
  currentProject: string;
  background: string;
};

const { currentProject, background } = Astro.props;

const projects = (await getCollection("portfolio"))
  .filter((project) => project.data.title !== currentProject)
  .sort(() => Math.random() - 0.5);
---

<aside class="w-full py-32" style={{ background }}>
  <h2 class="sr-only">My work</h2>
  <ol
    class="w-full px-12 pb-8 flex gap-12 overflow-x-auto snap-x snap-mandatory scroll-px-12"
  >
    {
      [...projects, ...projects].map((project, index) => (
        <li
          class="snap-always snap-end relative shrink-0 w-[75vw] md:w-[60vw] lg:w-[35vw]"
          aria-hidden={index > projects.length - 1}
        >
          <a
            class="h-full"
            href={`/portfolio/${project.slug}`}
            aria-label={`project: ${project.data.title},${project.data.description}`}
          >
            <Image
              src={project.data.heroImage}
              alt={project.data.description}
              aria-hidden="true"
            />
            <div class="font-extrabold text-xl">
              {project.data.title}{" "}
              <span class="font-light description">
                {project.data.description}
              </span>
            </div>
          </a>
        </li>
      ))
    }
  </ol>
</aside>

<style>
  .description::before {
    @apply inline-block px-1;
    content: "|";
  }
</style>
